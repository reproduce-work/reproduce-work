
[authors]
author1.name = "Alex P. Miller"
author1.affiliation = "USC Marshall School of Business"
author1.email = "alex.miller@marshall.usc.edu"

# reproduce.work configuration
[repro]
version = "reproduce.work/v1"
# Stages in the build/publish process
stages = ["build", "develop", "publish"]


[repro.files]
input = "document/main.md"
dynamic = "document/data.toml" # "dynamic" files are files that are generated by a script or the output of a programmatic analysis
latex_template = "document/latex/template.tex"
output = "document/latex/compiled.tex"

[repro.stage.build]
script = """
docker build -t literal .
docker build -t tinytex ./reproduce/Dockerfile.tinytex
"""

[repro.stage.develop]
script = """
docker run -v $(pwd):/home/jovyan -p 8888:8888 literal
"""

[repro.stage.publish]
script = """
docker run --rm -i -v $(pwd):/home/jovyan -p 8888:8888 literal python python/reproduce-work/build.py
docker run --rm -i --net=none -v $(pwd):/home tinytex sh -c "cd /home/document/latex && xelatex compiled.tex"
"""
    